{"remainingRequest":"/Users/nmadhab/hobby/social-network-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nmadhab/hobby/social-network-frontend/src/views/ListFriends.vue?vue&type=style&index=0&id=1868d166&scoped=true&lang=css&","dependencies":[{"path":"/Users/nmadhab/hobby/social-network-frontend/src/views/ListFriends.vue","mtime":1616736749825},{"path":"/Users/nmadhab/hobby/social-network-frontend/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nmadhab/hobby/social-network-frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/nmadhab/hobby/social-network-frontend/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/nmadhab/hobby/social-network-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nmadhab/hobby/social-network-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5pbWd7CiAgbWF4LXdpZHRoOiA3MHB4OwogIG1heC1oZWlnaHQ6IDcwcHg7Cn0K"},{"version":3,"sources":["ListFriends.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2FA;AACA;AACA;AACA","file":"ListFriends.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <b-container>\n    <b-row>\n      <b-col class=\"pt-5\">\n        <b-list-group class=\"list-group\">\n          <b-list-group-item class=\"d-flex justify-content-around\" v-for=\"item in users\" v-bind:key=\"item.id\">\n            <div class=\"col-4\" v-if=\"item.name === null\">\n              {{item.email}}\n            </div>\n            <div class=\"col-4\" v-else>\n              {{item.name}}\n            </div>\n\n            <div class=\"col-4 text-center\" >\n              <img class=\"img\"  thumbnail v-bind:src=\"item.picture\" alt=\"avatar\">\n            </div>\n            <div class=\"col-4 text-right\">\n              <button class=\"btn btn-primary pull-right\" @click=\"fetchRoom(item.id, item.name || item.email)\">Chat</button>\n            </div>\n          </b-list-group-item>\n        </b-list-group>\n      </b-col>\n    </b-row>\n  </b-container>\n</template>\n\n<script>\nimport axios from 'axios';\nimport {API_BASE_URL} from '/src/config.js';\nimport firebase from \"../firebase\";\n\nexport default {\n  name: \"ListFriends\",\n  data() {\n    return {\n      users: [],\n      email: '',\n      username: localStorage.getItem('username'),\n      ref: firebase.database().ref('chatrooms/')\n    }\n  },\n  methods: {\n    listFriends(){\n      axios.get(`${API_BASE_URL}private/listFriends`,{'headers' :{\n          'Authorization': 'Bearer '+localStorage.getItem('idToken'),\n        }}).then(resp => {\n        console.log(resp.data);\n        if(resp.status === 200){\n          this.users = resp.data;\n        }\n      }).catch(err => console.log(err))\n    },\n    fetchRoom(id, friendName) {\n      console.log(id);\n      axios.get(`${API_BASE_URL}private/getRoomName?friendId=${id}`, {'headers':{\n          'Authorization': 'Bearer '+localStorage.getItem('idToken'),\n      }}).then(resp => {\n        console.log(resp.data);\n        this.ref.orderByChild('roomName').equalTo(resp.data).once('value', snapshot => {\n          if (snapshot.exists()) {\n            console.log('Room Exists');\n            snapshot.forEach((doc) => {\n              console.log(doc.key);\n              this.$router.push({name: 'Chat', params: {nickname: localStorage.getItem('username'), roomid: doc.key, roomname: resp.data, friend: friendName}});\n              return true;\n            })\n          }\n          else {\n            console.log(\"Does not Exist\")\n            let newData = this.ref.push()\n            newData.set({\n              roomName: resp.data\n            })\n          }\n        })\n      }).catch(err => console.log(err))\n    }\n  },\n  mounted() {\n    if (!this.username) {\n      this.$router.push('/login')\n    }\n    else {\n      this.listFriends();\n    }\n  }\n}\n</script>\n\n<style scoped>\n\n.img{\n  max-width: 70px;\n  max-height: 70px;\n}\n</style>\n"]}]}